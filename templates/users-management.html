{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ادخال فاتورة بيع</title>
    <!-- Bootstrap CSS -->
    <link
      href="{% static 'bootstrap-5.0.2-dist/css/bootstrap.min.css' %}"
      rel="stylesheet"
    />

    <!-- Bootstrap JS -->
    <script src="{% static 'bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js' %}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <link rel="stylesheet" href="{% static 'CSS/login.css' %}" />
    <link
      rel="stylesheet"
      href="{% static 'tabulator/tabulator_bootstrap5.min.css' %}"
    />
    <link
      rel="stylesheet"
      href="{% static 'tabulator/custom-tabulator.css' %}"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'dselect/choices.min.css' %}" />

    <style>
      .choices {
        width: calc(100% - 73px); /*edit later*/
      }
      .dropdown {
        display: none;
        /* Initially hidden */
        position: absolute;
        background-color: white;
        border: 1px solid #ccc;
        padding: 10px;
        z-index: 1000;
      }

      .width-95 {
        width: 95px;
      }

      .width-55 {
        width: 55px;
      }
      .width-user {
        width: calc(100% - 73px);
      }
      .width-170 {
        width: 170px;
      }
      .width-73 {
        width: 73px;
      }

      .width-80 {
        width: 110px;
      }

      .dropdown label {
        display: block;
      }

      #contextMenu {
        display: none;
        /* Hidden by default */
        position: absolute;
        background-color: #ffffff;
        border: 1px solid #cccccc;
        padding: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        min-width: 150px;
      }

      .bi-question-circle {
        padding-left: 2px;
        font-size: 12px;
      }

      .bi-question-circle:hover {
        color: #007bff;
        /* Change color as needed */
      }

      #contextMenu div {
        padding: 8px 12px;
        cursor: pointer;
      }

      #contextMenu div:hover {
        background-color: #f0f0f0;
      }

      .large-textarea {
        height: 235px;
        /* Set a specific height for the textarea (adjust as needed) */
      }

      /* Set a fixed height for the Tabulator container */
      /* Container for the table */

      /* Container for the table */

      .button-row {
        display: flex;
        justify-content: space-between;
        /* Distributes space evenly between buttons */
        width: 100%;
        /* Full width of the parent container */
      }

      .row {
        direction: rtl;
        /* Set the direction of the row to right-to-left */
      }

      .form-label,
      .form-control {
        direction: ltr;
        /* Make sure inputs and labels align correctly within the form */
      }

      .button-row .btn {
        flex: 1;
        /* Each button takes up equal space */
        margin: 0 5px;
        /* Optional: Add space between buttons */
      }

      .small-input {
        max-width: 50px !important;
        min-width: 50px !important;
      }

      form label {
        margin-bottom: 0px;
      }

      th,
      td {
        padding: 2px;
        /* Decrease padding */
        font-size: 13px;
        /* Decrease font size */
        border: 1px solid #ddd;
        /* Add borders for visibility */
      }

      input.form-control {
        padding: 5px;
        /* Decrease padding */
        font-size: 12px;
        /* Decrease font size */
        height: 30px;
        /* Set a fixed height (optional) */
        border-radius: 0;
        text-align: right;
        direction: rtl;
      }

      select.form-select {
        padding: 5px;
        /* Decrease padding for select fields */
        font-size: 12px;
        /* Decrease font size */
        height: 30px;
        /* Set a fixed height for select fields (optional) */
        border-radius: 0;
        text-align: center;
      }

      h1,
      h2,
      h3,
      label,
      p,
      table thead tbody {
        font-size: 15px;
        margin: 0;
      }

      html,
      body {
        height: 100%;
        margin: 0;
        text-align: right;
        font-size: 15px;
      }

      body {
        background-color: #f5f5f5;
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .container {
        max-width: 1200px;
        width: 100%;
        height: 100%;
        background-color: #fff;
        padding: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .btn-primary {
        width: 100%;
      }

      .editable {
        cursor: pointer;
        background-color: #f9f9f9;
        padding-right: 5px;
      }

      .editable:focus {
        outline: none;
        background-color: #e6e6e6;
      }

      .custom-table {
        height: 100%;
        overflow-y: hidden;
      }

      #users-table {
        height: 100% !important;
        max-height: none;
      }

      table {
        width: 100%;
        margin: 0px;
      }

      thead {
        background-color: #b3c9df;
        color: rgb(0, 0, 0);
        padding: 2px;
      }

      table thead th {
        position: sticky;
        top: 0;
        background-color: #343a40;
        z-index: 1;
      }

      .title-container {
        background-color: #b3c9df;
        text-align: center;
        padding: 3px 0px;
        margin-bottom: 4px;
      }

      /* Create a wrapper around the select element */
      .custom-select-container {
        position: relative;
        display: inline-block;
        width: 100%;
      }

      .button-row {
        display: flex;
        justify-content: space-between;
        /* Distributes space evenly between buttons */
        width: 100%;
        /* Full width of the parent container */
        margin: 0;
        /* Ensure no extra margins are added */
        padding: 0 0px;
        /* Add padding to the row */
        box-sizing: border-box;
        /* Ensure padding is included in the width calculation */
      }

      .button-row .btn {
        flex: 1;
        /* Each button takes up equal space */
        margin: 0 5px;
        /* Add space between buttons */
      }

      /* Move the arrow to the left */
      .form-select {
        padding-left: 2.5rem;
        /* Add space on the left for the icon */
        padding-right: 1rem;
        /* Adjust right padding */
        background: none;
        /* Remove default background */
      }

      .custom-select-container::before {
        content: "▾";
        /* The caret symbol */
        position: absolute;
        left: 0.75rem;
        /* Position it to the left */
        top: 50%;
        transform: translateY(-50%);
        /* Center vertically */
        pointer-events: none;
        /* Prevent interaction with the icon */
        color: #000;
        /* Icon color (can be customized) */
      }

      /* Hide default dropdown arrow */
      .form-select {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
      }

      .form-select-with-icon {
        -webkit-appearance: auto;
        -moz-appearance: auto;
        appearance: auto;

        -webkit-text-size-adjust: 100%;
        -webkit-tap-highlight-color: transparent;
        --bs-gutter-x: 1.5rem;
        --bs-gutter-y: 0;
        direction: rtl;
        box-sizing: border-box;
        margin: 0;
        font-family: inherit;
        text-transform: none;
        word-wrap: normal;
        --bs-form-select-bg-img: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m2 5 6 6 6-6'/%3e%3c/svg%3e");
        display: block;
        font-weight: 400;
        line-height: 1.5;
        color: var(--bs-body-color);
        border: 1px solid #ced4da;
        transition:
          border-color 0.15s ease-in-out,
          box-shadow 0.15s ease-in-out;
        background: none;
        padding: 5px;
        font-size: 12px;
        height: 30px;
        border-radius: 0;
        text-align: center;
        position: relative;
        flex: 1 1 auto;
        width: 1%;
      }

      /*//////////////////*/
      .custom-form {
        width: 100%;
        padding: 0px 10px;
      }

      .row {
        display: flex;
        /* Use flexbox for layout */
        margin-bottom: 5px;
        /* Minimize vertical space */
      }

      .col-md-2,
      .col-md-3 {
        padding: 0 5px;
        /* Reduce horizontal padding */
      }

      .form-label {
        font-size: 12px;
        /* Reduce font size */
        margin-bottom: 2px;
        /* Minimize label space */
        margin-left: 10px;
      }
      .form-box {
        height: 100px;
        width: 100%;
        /* Adjust input height */
        font-size: 12px;
        /* Reduce font size */
      }
      .form-control {
        height: 30px;
        /* Adjust input height */
        font-size: 12px;
        /* Reduce font size */
      }

      .form-select {
        height: 30px;
        /* Adjust select height */
        font-size: 12px;
        /* Reduce font size */
      }

      .button-row {
        display: flex;
        flex-wrap: nowrap;
        /* Prevent wrapping */
        justify-content: space-between;
        /* Space buttons evenly */
        margin-top: 5px;
        /* Minimize space above button row */
      }

      button {
        font-size: 12px;
        /* Reduce button text size */
        padding: 2px 5px;
        /* Reduce button padding */
      }

      .custom-table table {
        border-collapse: collapse;
        /* Combine borders of adjacent cells */
      }

      .custom-table th,
      .custom-table td {
        padding: 0;
        /* Remove all padding */
        padding-right: 5px;
        margin: 0;
        /* Ensure no margins are applied */
        height: auto;
        /* Allow cells to have minimal height */
      }

      input[type="number"] {
        direction: rtl;
        /* For Arabic alignment */
        padding-left: 2px;
        /* Adds padding to the left to avoid overflow */
        text-align: right;
        /* Aligns the text inside the input to the right */
        width: 100%;
        /* Ensure full width */
      }

      /* Style for number input to always show increment/decrement arrows */
      input[type="number"]::-webkit-outer-spin-button,
      input[type="number"]::-webkit-inner-spin-button {
        opacity: 1;
        pointer-events: auto;
      }

      /* Adjust for other browsers */
      input[type="number"] {
        -moz-appearance: textfield;
        appearance: textfield;
        /* Hides spinner on Firefox */
      }

      .modal-body {
        max-height: 300px;
        /* Set max height for modal body */
        overflow-y: auto;
        /* Enable scrolling in modal body */
      }

      .column-menu-btn {
        font-size: 12px;
        padding: 5px;
      }
      .max-width-500{
        max-width: 500px;
      }
      #permissions-container{
        overflow-y: auto;
        overflow-x: hidden;
        height: 450px;
      }
    </style>
  </head>
  <body>
    <div class="container row">
        <div class="col-6 h-100 ">
          <div class="title-container mb-2">
            <h3 class="m-0">تقارير الخزينة</h3>
          </div>

          <!-- Table Section -->
          <div class="custom-table mb-1">
            <div
              dir="rtl"
              id="users-table"
              data-url="{% url 'get_data' %}"
              class="table table-striped table-bordered table-hover"
            ></div>
          </div>
        </div>

      <!-- Form Section with 5 input columns -->
        <div class="col-6">
            <div class="custom-form">
                <form id="firstForm" lang="ar">
                {% csrf_token %}

                <div class="row">
                    <!-- First column -->
                    <div class="col">
                        <div class="input-group mb-1">
                          <div class="width-70 d-flex align-items-center">
                            <label for="storage-balance" class="form-label">رقم المستخدم</label>
                          </div>
                          <input type="text" class="form-control" id="user-no" />
                        </div>
                        <div class="input-group mb-1">
                          <div class="width-70 d-flex align-items-center">
                            <label for="storage-balance" class="form-label">اسم المستخدم</label>
                          </div>
                          <input type="text" class="form-control" id="user-name" />
                        </div>
                        <div class="input-group mb-1">
                          <div class="width-70 d-flex align-items-center">
                            <label for="storage-balance" class="form-label">كلمة المرور</label>
                          </div>
                          <input type="text" class="form-control" id="password"  />
                        </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">تحديد كل الصلاحيات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">ايقاف الحساب</label>
                      </div>

                    </div>
                </div>
                </form>
            </div>
            <div id="permissions-container">
              <div id="products_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3>واجهات الاصناف</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_products" />
                    </div>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_productdetails" value="template_productdetails" style="margin-left: 5px" />
                        <label for="template_productdetails">صفحة بيانات الاصناف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_local_item_reports" value="template_local_item_reports" style="margin-left: 5px" />
                        <label for="template_local_item_reports">تقارير الاصناف المحلية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_external_item_reports" value="template_external_item_reports" style="margin-left: 5px" />
                        <label for="template_external_item_reports">تقارير الاصناف الخارجية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_price_modifications" value="template_price_modifications" style="margin-left: 5px" />
                        <label for="template_price_modifications">تعديل الاسعار</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_item_movement_reports" value="template_item_movement_reports" style="margin-left: 5px" />
                        <label for="template_item_movement_reports">تقرير حركة الاصناف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_item_revaluation" value="template_item_revaluation" style="margin-left: 5px" />
                        <label for="template_item_revaluation">اعادة ترصيد الاصناف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_inventory" value="template_inventory" style="margin-left: 5px" />
                        <label for="template_inventory">الجرد</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_damage_loss" value="template_damage_loss" style="margin-left: 5px" />
                        <label for="template_damage_loss">التلف والفقد</label>
                      </div>
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_mainitem" style="margin-left: 5px" />
                          <label for="check1">ادخال صنف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_mainitem" style="margin-left: 5px" />
                          <label for="check1">تعديل صنف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_mainitem" style="margin-left: 5px" />
                          <label for="check1">حذف صنف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_mainitems" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                      </div>
                    </div>

                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_storage_locations" value="template_storage_locations" style="margin-left: 5px" />
                        <label for="template_storage_locations">اماكن التخزين</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_english_labeling" value="template_english_labeling" style="margin-left: 5px" />
                        <label for="template_english_labeling">التسمية الانجليزية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_item_reservation" value="template_item_reservation" style="margin-left: 5px" />
                        <label for="template_item_reservation">حجز اصناف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_revaluation" value="template_revaluation" style="margin-left: 5px" />
                        <label for="template_revaluation">اعادة الترصيد</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_missing_items" value="template_missing_items" style="margin-left: 5px" />
                        <label for="template_missing_items">النواقص</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_issue_permits" value="template_issue_permits" style="margin-left: 5px" />
                        <label for="template_issue_permits">اذونات الصرف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_items_with_notes" value="template_items_with_notes" style="margin-left: 5px" />
                        <label for="template_items_with_notes">اصناف بالملاحظات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="template_add_item_specifications" value="template_add_item_specifications" style="margin-left: 5px" />
                        <label for="template_add_item_specifications">اضافة مواصفات الصنف</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="buy_invoice_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات فواتير الشراء</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_buy_invoice" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_invoice_entry" style="margin-left: 5px" />
                        <label for="check1">واجهة ادخال فاتورة شراء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_invoices" style="margin-left: 5px" />
                        <label for="check1">فواتير الشراء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_price_modifications" style="margin-left: 5px" />
                        <label for="check1">تعديل اسعار البيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_invoice_settlement" style="margin-left: 5px" />
                        <label for="check1">تسوية حساب فواتير الشراء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_temp_item_posting" style="margin-left: 5px" />
                        <label for="check1">ترحيل الاصناف المؤقتة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_buy_invoice_inventory" style="margin-left: 5px" />
                        <label for="check1">جرد فواتير الشراء</label>
                      </div>

                    </div>
                    <div class="col">
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_buyinvoicetable" style="margin-left: 5px" />
                          <label for="check1">اصدار فاتورة شراء</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_buyinvoicetable" style="margin-left: 5px" />
                          <label for="check1">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_buyinvoicetable" style="margin-left: 5px" />
                          <label for="check1">حذف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="buy_invoice_export" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_total_buyinvoice" style="margin-left: 5px" />
                          <label for="check1">عرض تفاصيل المجاميع</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="sell_invoice_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات فواتير البيع</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_sell_invoice" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_sell_invoice_entry" style="margin-left: 5px" />
                        <label for="check1">واجهة ادخال فاتورة بيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_sell_invoices" style="margin-left: 5px" />
                        <label for="check1">فواتير البيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_sell_invoice_settlement" style="margin-left: 5px" />
                        <label for="check1">تسوية حساب فواتير البيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_sell_inventory_item_search" style="margin-left: 5px" />
                        <label for="check1">بحث بالاصناف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_sell_invoice_preparation_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير التحضير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="view_sellinvoicetable" style="margin-left: 5px" />
                        <label for="check1">الاطلاع على الفواتير</label>
                      </div>
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_sellinvoicetable" style="margin-left: 5px" />
                          <label for="check1">اصدار فاتورة بيع</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_sellinvoicetable" style="margin-left: 5px" />
                          <label for="check1">تعديل فواتير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_sellinvoicetable" style="margin-left: 5px" />
                          <label for="check1">حذف فواتير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                      </div>
                    </div>
                    <div class="col">
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_total_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">عرض المجاميع</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_items_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">عرض الاصناف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="prepare_input_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تحضير فاتورة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_sell_price_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">عرض سعر البيع</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="custom_export_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تصدير مخصص</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="edit_sell_price_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تعديل السعر</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="edit_quantity_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تعديل الكمية</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="fixed_date_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تثبيت التاريخ في فواتير البيع</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="fixed_date_prepare_sellinvoice" style="margin-left: 5px" />
                          <label for="check1">تثبيت التاريخ في تقارير التحضير</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="return_permission_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات الترجيع</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_return_permission" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_return_permission_entry" style="margin-left: 5px" />
                        <label for="check1">ادخال اذن ترجيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_return_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير الترجيع</label>
                      </div>

                    </div>
                    <div class="col">
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_return_permission" style="margin-left: 5px" />
                          <label for="check1">اضافة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_return_permission" style="margin-left: 5px" />
                          <label for="check1">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_return_permission" style="margin-left: 5px" />
                          <label for="check1">حذف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_return_permissions" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="clients_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات العملاء</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_clients" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_customer_guide" style="margin-left: 5px" />
                        <label for="check1">دليل العملاء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_customer_reports"  style="margin-left: 5px" />
                        <label for="check1">تقارير العملاء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_account_settlement" style="margin-left: 5px" />
                        <label for="check1">تسوية حساب</label>
                      </div>

                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_account_settlement_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير تسوية الحساب</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_audit_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير المراجعة</label>
                      </div>
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="edit_account_statement_clients" style="margin-left: 5px" />
                          <label for="check1">تعديل كشف الحساب</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_allclientstable" style="margin-left: 5px" />
                          <label for="check1">اضافة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_allclientstable" style="margin-left: 5px" />
                          <label for="check1">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_allclientstable" style="margin-left: 5px" />
                          <label for="check1">حذف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_clients" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_total_clients" style="margin-left: 5px" />
                          <label for="check1">عرض تفاصيل المجاميع</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="sources_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات الموردين</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_suppliers" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_add_supplier" style="margin-left: 5px" />
                        <label for="check1">اضافة مورد</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_supplier_guide" style="margin-left: 5px" />
                        <label for="check1">دليل الموردين</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_supplier_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير الموردين</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_supplier_account_settlement" style="margin-left: 5px" />
                        <label for="check1">تسوية حساب</label>
                      </div>


                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_supplier_account_settlement_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير تسوية الحساب</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_audit_reports_suppliers" style="margin-left: 5px" />
                        <label for="check1">تقارير المراجعة للموردين</label>
                      </div>
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="edit_account_statement_suppliers" style="margin-left: 5px" />
                          <label for="check1">تعديل كشف الحساب</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_suppliers" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_total_suppliers" style="margin-left: 5px" />
                          <label for="check1">عرض تفاصيل المجاميع</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_allsourcestable" style="margin-left: 5px" />
                          <label for="check1">اضافة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_allsourcestable" style="margin-left: 5px" />
                          <label for="check1">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_allsourcestable" style="margin-left: 5px" />
                          <label for="check1">حذف</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="employees_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات الموظفين</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_employees" />
                    </div>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_employee_directory" style="margin-left: 5px" />
                        <label for="check1">دليل الموظفين</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_emp_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير الموظفين</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_salary_accounts" style="margin-left: 5px" />
                        <label for="check1">حساب المرتبات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_settlement_entries" style="margin-left: 5px" />
                        <label for="check1">تسوية حساب</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_emp_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_settlement_reports" style="margin-left: 5px" />
                        <label for="check1">تقارير التسوية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_attendance_absence" style="margin-left: 5px" />
                        <label for="check1">حضور وغياب</label>
                      </div>
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_employeestable" style="margin-left: 5px" />
                          <label for="check1">اضافة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_employeestable" style="margin-left: 5px" />
                          <label for="check1">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_employeestable" style="margin-left: 5px" />
                          <label for="check1">حذف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_employees" style="margin-left: 5px" />
                          <label for="check1">تصدير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="edit_account_employees" style="margin-left: 5px" />
                          <label for="check1">تعديل الحساب</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="allow_over_salary_depts_employees" style="margin-left: 5px" />
                          <label for="check1">السماح بالصرف بتجاوز المرتب</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="storage_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات الخزينة</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_storage" />
                    </div>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_treasury_entries" style="margin-left: 5px" />
                        <label for="treasury-check1">قيود الخزينة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_treasury_reports" style="margin-left: 5px" />
                        <label for="treasury-check2">تقارير الخزينة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_request_value" style="margin-left: 5px" />
                        <label for="treasury-check2">طلب قيمة من الخزينة</label>
                      </div>

                    </div>
                    <div class="col">
                      <div class="border p-1">
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="template_treasury_movements" style="margin-left: 5px" />
                          <label for="treasury-check2">حركة الخزينة</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_storagetransactionstable" style="margin-left: 5px" />
                          <label for="treasury-check2">ادخال</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="change_storagetransactionstable" style="margin-left: 5px" />
                          <label for="treasury-check2">تعديل</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="delete_storagetransactionstable" style="margin-left: 5px" />
                          <label for="treasury-check2">حذف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="export_treasury" style="margin-left: 5px" />
                          <label for="treasury-check2">تصدير</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="show_withdraw_records_treasury" style="margin-left: 5px" />
                          <label for="treasury-check2">عرض قيود الصرف</label>
                        </div>
                        <div class="row-md-2 d-flex align-items-center mb-2">
                          <input type="checkbox" value="add_withdraw_records_treasury" style="margin-left: 5px" />
                          <label for="treasury-check2">ادخال قيود الصرف</label>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="accounts_templates" class="row">
                <div class="col">
                  <div class="row border title-container">
                    <h3 class="text-center">x صلاحيات الحسابات</h3>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x الحسابات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x قيود الحسابات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check2" style="margin-left: 5px" />
                        <label for="treasury-check2">x تقارير الحسابات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check2" style="margin-left: 5px" />
                        <label for="treasury-check2">x تسوية حساب</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check3" style="margin-left: 5px" />
                        <label for="treasury-check3">x حركة حساب</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check3" style="margin-left: 5px" />
                        <label for="treasury-check3">x حساب تفصيلي</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check3" style="margin-left: 5px" />
                        <label for="treasury-check3">x حساب الاصناف</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check3" style="margin-left: 5px" />
                        <label for="treasury-check3">x حساب اليومية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check2" style="margin-left: 5px" />
                        <label for="treasury-check2">x ادخال</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check2" style="margin-left: 5px" />
                        <label for="treasury-check2">x تصدير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check2" style="margin-left: 5px" />
                        <label for="treasury-check2">x حذف</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div id="users_templates" class="row">
                <div class="col">
                  <div class="row border title-container align-items-center" style="direction: ltr;">
                    <div class="col text-center">
                      <h3 class="text-center">صلاحيات المستخدمين</h3>
                    </div>
                    <div class="col-auto mx-1">
                      <input type="checkbox" value="category_users" />
                    </div>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" value="template_users_management" style="margin-left: 5px" />
                        <label for="treasury-check1">ادارة المستخدمين</label>
                      </div>

                    </div>
                    <div class="col">

                    </div>
                  </div>
                </div>
              </div>
               <div id="manufac_order" class="row">
                <div class="col">
                  <div class="row border title-container">
                    <h3 class="text-center">x اوامر التصنيع</h3>
                  </div>
                  <div class="row border ">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x ادخال امر تصنيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x اوامر التصنيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x تقارير التصنيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x بحث بالاصناف</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x تعديل</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x حذف</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x تصدير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x ادخال الكثافة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox"  style="margin-left: 5px" />
                        <label for="check1">x تعديل السعر</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <div class="row border title-container">
                    <h3 class="text-center">x صلاحيات الاعدادات</h3>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x نسخ قاعدة البيانات</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x اعداد حساب اول المدة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تسجيل النسخة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x الغاء قفل الاستخدام</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x وثائق</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x نسخ قاعدة بيانات الصور</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض الرقم الاصلي</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row disabled-div">
                <div class="col">
                  <div class="row border title-container">
                    <h3 class="text-center">x صلاحيات الاعدادات</h3>
                  </div>
                  <div class="row border">
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تغيير كلمة السر</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض اسعار الشراء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض اسعار التكلفة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x طباعة التقارير و الفواتير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تعديل الفواتير السابقة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x قفل الجهاز عند انهاء النظام</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تكبير شاشة التحضير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عدم عرض الاسعار بفاتورة البيع</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تفاصيل حساب اليومية</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض قيود المراجعة</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x لون تغيير السعر بفاتورة البيع</label>
                      </div>
                    </div>
                    <div class="col">
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض تنبيه الوثائق</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض القائمة لشاشة التحضير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تحضير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تسليم</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x الغاء التسليم</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تحديد نوع التقرير بالتحضير</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تحديد اسم المحطة لهذا المستخدم</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x تسجيل دخول تلقائي</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض شاشة الجرد تلقائيا</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض تنبيه فواتير الشراء</label>
                      </div>
                      <div class="row-md-2 d-flex align-items-center mb-2">
                        <input type="checkbox" id="treasury-check1" style="margin-left: 5px" />
                        <label for="treasury-check1">x عرض حركة تسجيل الدخول</label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="mb-1 d-flex align-items-center">
                  <div style="width: 100px">
                    <label for="original-no" class="form-label"
                      >اسم المحطة</label
                    >
                  </div>
                  <input
                    type="text"
                    class="form-control"
                    id="original-no"
                    placeholder="Enter value"
                    required
                  />
                </div>
              </div>
            </div>
            <div class="row mt-4">
              <div class="col-12 d-flex justify-content-center gap-2 flex-wrap">
                <button type="button" id="clear-btn" class="btn btn-primary" style="width: 100px">مسح</button>
                <button type="button" class="btn btn-primary" style="width: 100px">جديد</button>
                <button type="button" class="btn btn-primary" style="width: 100px">حذف</button>
                <button type="button" class="btn btn-primary" style="width: 100px" onClick="window.close()">اغلاق</button>
              </div>
            </div>

        </div>
    </div>
    <script src="{% static 'bootstrap-5.0.2-dist/js/bootstrap.bundle.min.js' %}"></script>

    <!-- Use jQuery -->

    <script src="{% static 'tabulator/tabulator.min.js' %}"></script>
    <script src="{% static 'dselect/choices.min.js' %}"></script>

    <script src="{% static 'sheetjs/xlsx.full.min.js' %}"></script>
    <script src="{% static 'js/helper_functions.js' %}"></script>
    <script>
      const jwtToken_access = localStorage.getItem("session_data@access_token").replace(/"/g, '');

      const table = new Tabulator("#users-table", {
        height: "auto",
        layout: "fitColumns",
        selectable: true,
        rowHeight: 20,
        movableColumns: true,
        columnHeaderVertAlign: "bottom",
        columnMenu: true, // Enable column menu
        data: [], // Load dynamically
        columns: [
            { title: "رقم المستخدم", field: "id", visible: true, width: 95},
            { title: "اسم المستخدم", field: "username", visible: true, width: 95 },
            {
              title: "اخر دخول",
              field: "last_login",
              visible: true,
              width: 135,
              formatter: function(cell) {
                const value = cell.getValue();
                if (!value) return "-";
                const date = new Date(value);
                return date.toLocaleString(); // You can use options to customize format
              }
            },
            {
              title: "ادمن",
              field: "is_superuser",
              visible: true,
              formatter: function(cell) {
                return cell.getValue() ? "✓" : "✗";
              },
              width: 60,
            },
            {
              title: "موظف",
              field: "is_superuser",
              visible: true,
              formatter: function(cell) {
                return cell.getValue() ? "✗":"✓";
              },
              width: 60,
            },
            {
              title: "نشط",
              field: "is_active",
              visible: true,
              formatter: function(cell) {
                return cell.getValue() ? "✓" : "✗";
              },
              width: 60,
            },
            //{ title: "الاسم", field: "first_name", visible: true },
            //{ title: "اللقب", field: "last_name", visible: true },

        ],
        placeholder: "لا توجد بيانات متاحة",
    });
    refreshTable();
    function refreshTable(){
         customFetch("/api/users/get", {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
            },
          })
          .then((response) => response.json())
          .then((data) => {
            console.log("Fetched Data:", data);

            // Set data in Tabulator
            table.setData(data);
          })
          .catch((error) => console.error("Error fetching data:", error)).finally(()=> {

          });
       }
       function updatePermissionCheckboxes(responseData) {
          const permissions = new Set(responseData);  // Convert to Set for fast lookup
          const checkboxes = document.querySelectorAll('#permissions-container input[type="checkbox"]');

          checkboxes.forEach((checkbox) => {
            checkbox.checked = permissions.has(checkbox.value);
          });
        }
       function getPermissions(id){
         customFetch("/api/users/"+ id +"/permissions", {
            method: "GET",
            headers: {
              "Content-Type": "application/json",
            },
          })
          .then((response) => response.json())
          .then((data) => {
            updatePermissionCheckboxes(data);
          })
          .catch((error) => console.error("Error fetching data:", error)).finally(()=> {

          });
       }
    document.addEventListener("DOMContentLoaded", function () {
      const checkboxes = document.querySelectorAll('#permissions-container input[type="checkbox"]');

      checkboxes.forEach(function (checkbox) {
        checkbox.addEventListener("change", function () {
          const permissionCodename = this.value;
          const action = this.checked ? "grant" : "remove";
          const id = document.getElementById("user-no").value;

          if (!id) {
            alert("يرجى اختيار مستخدم أولاً.");
            this.checked = !this.checked; // Uncheck the checkbox
            return;
          }

          fetch("http://45.13.59.226/api/user/permissions/toggle", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              // Add Authorization if needed
              // "Authorization": "Bearer YOUR_TOKEN"
            },
            body: JSON.stringify({
              user_id: id,
              permission_codename: permissionCodename,
              action: action
            })
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Request failed');
            }
            return response.json();
          })
          .then(data => {
            alert('Success:'+ data.arabic_message);
          })
          .catch(error => {
            console.error('Error:', error);
            // Optionally uncheck if request fails
            this.checked = !this.checked;
            alert("فشل في حفظ الصلاحية. حاول مجددا.");
          });
        });
      });
      all_permissions_check.addEventListener("change", function () {
        const id = document.getElementById("user-no").value;

          if (!id) {
            alert("يرجى اختيار مستخدم أولاً.");
            this.checked = !this.checked; // Uncheck the checkbox
            return;
          }

          fetch("/api/user/permissions/give-all-permissions/toggle", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              id: id,
            })
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Request failed');
            }
            return response.json();
          })
          .then(data => {
            alert('Success:'+ data.message);
          })
          .catch(error => {
            console.error('Error:', error);
            // Optionally uncheck if request fails
            this.checked = !this.checked;
            alert("فشل في حفظ الصلاحية. حاول مجددا.");
          });
      });
      is_active_toggle_check.addEventListener("change", function () {
        const id = document.getElementById("user-no").value;

          if (!id) {
            alert("يرجى اختيار مستخدم أولاً.");
            this.checked = !this.checked; // Uncheck the checkbox
            return;
          }

          fetch("/api/user/activate/toggle", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              id: id,
            })
          })
          .then(response => {
            if (!response.ok) {
              throw new Error('Request failed');
            }
            return response.json();
          })
          .then(data => {
            alert('Success:'+ data.message);
          })
          .catch(error => {
            console.error('Error:', error);
            // Optionally uncheck if request fails
            this.checked = !this.checked;
            alert("فشل في حفظ الصلاحية. حاول مجددا.");
          });
      });

    });
    async function updateUserStatusCheckboxes(userId) {
      const allPermissionsCheck = document.getElementById("all_permissions_check");
      const isActiveToggleCheck = document.getElementById("is_active_toggle_check");

      if (!userId) {
        console.error("User ID is required.");
        return;
      }

      try {
        const response = await fetch(`/api/user-status/?id=${userId}`, {
          method: 'GET',
          headers: {
            'Content-Type': 'application/json',
          },
        });

        if (!response.ok) {
          const errorData = await response.json();
          console.error("Error:", errorData.error || "Failed to fetch user status.");
          return;
        }

        const data = await response.json();

        // Set checkbox states
        isActiveToggleCheck.checked = data.is_active;
        allPermissionsCheck.checked = data.in_full_access_group;

      } catch (error) {
        console.error("Error fetching user status:", error);
      }
    }

    table.on("rowClick", function (e, row) {
          console.log("Row clicked after data update:", row.getData());
          const id = parseInt(row.getData().id); // Get pno of the clicked row
          const username = row.getData().username;

          document.getElementById("user-no").value = id;
          document.getElementById("user-name").value = username;

          getPermissions(id);
          console.log("Clicked id:", id);
        });
    </script>

  </body>
</html>
